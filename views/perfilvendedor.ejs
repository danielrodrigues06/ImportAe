<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil do Vendedor</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <div class="row">
      <div class="col-md-8">
        <div class="card mb-4">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <img src="/imagens/<%= vendedor.fotoPerfil || 'default.png' %>" alt="Foto do Vendedor" class="img-fluid rounded-circle" width="100">
              <div class="ml-3">
                <h3><%= vendedor.nome %></h3>
                <p>Importa de: <%= vendedor.deOndeImporta %></p>
                <p>No ImportAe desde: <%= new Date(vendedor.createdAt).toLocaleString('pt-BR', { month: 'long', year: 'numeric' }) %></p>
                <a href="/chat?destinatarioId=<%= vendedor.id %>" class="btn btn-info">Conversar com o Vendedor</a>
              </div>
            </div>
            <div class="mt-4">
              <h4>Sobre Mim</h4>
              <p><%= vendedor.sobreMim %></p>
            </div>
          </div>
        </div>

        <div class="card mb-4">
          <div class="card-body">
            <h4>Avaliações</h4>
            <% if (notaMedia) { %>
              <p>Nota Média: <%= notaMedia %>/5 estrelas</p>
            <% } else { %>
              <p>Este vendedor ainda não possui avaliações.</p>
            <% } %>
            <% if (avaliacoes.length > 0) { %>
              <div class="media mb-3">
                <img src="/imagens/<%= avaliacoes[0].cliente.fotoPerfil || 'default.png' %>" alt="Foto do Cliente" class="mr-3 img-fluid rounded-circle" width="50">
                <div class="media-body">
                  <h5 class="mt-0"><%= avaliacoes[0].cliente.nome %></h5>
                  <p>Nota: <%= avaliacoes[0].nota %>/5</p>
                  <p><%= avaliacoes[0].comentario %></p>
                  <% if (Array.isArray(avaliacoes[0].fotos) && avaliacoes[0].fotos.length > 0) { %>
                    <div class="mt-2">
                      <% avaliacoes[0].fotos.forEach(foto => { %>
                        <img src="/imagens/<%= foto %>" alt="Foto da Avaliação" class="img-fluid" width="100">
                      <% }); %>
                    </div>
                  <% } %>
                </div>
              </div>
            <% } %>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <h4>Produtos</h4>
        <% vendedor.produtos.forEach(produto => { %>
          <div class="card mb-3">
            <div class="card-body">
              <h5 class="card-title"><%= produto.nome %></h5>
              <p class="card-text">Preço: R$ <%= produto.preco %></p>
              <a href="/comprar/<%= produto.id %>" class="btn btn-primary">Comprar</a>
            </div>
          </div>
        <% }); %>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.6/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>